<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Units and parameter choice · SpiDy.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://quantum-exeter.github.io/SpiDy.jl/units/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="SpiDy.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="SpiDy.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpiDy.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Start with SpiDy.jl</a></li><li class="is-active"><a class="tocitem" href>Units and parameter choice</a><ul class="internal"><li><a class="tocitem" href="#Units-and-choice-of-input-parameters"><span>Units and choice of input parameters</span></a></li><li><a class="tocitem" href="#Extracting-Lorentzian-units-from-experimental-data"><span>Extracting Lorentzian units from experimental data</span></a></li></ul></li><li><a class="tocitem" href="../noise/">Noise</a></li><li><a class="tocitem" href="../spectraldensity/">Spectral density</a></li><li><a class="tocitem" href="../stochasticfield/">Stochastic field</a></li><li><a class="tocitem" href="../couplingtensor/">Spin-environment coupling tensor</a></li><li><a class="tocitem" href="../couplingfunctions/">Spin-spin interactions</a></li><li><a class="tocitem" href="../dynamics/">Dynamics</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Units and parameter choice</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Units and parameter choice</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/quantum-exeter/SpiDy.jl/blob/main/docs/src/units.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Units-and-choice-of-input-parameters"><a class="docs-heading-anchor" href="#Units-and-choice-of-input-parameters">Units and choice of input parameters</a><a id="Units-and-choice-of-input-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Units-and-choice-of-input-parameters" title="Permalink"></a></h2><p>In this document we describe the choice of units implemented in SpiDy.jl (which follows the conventions utilised in  <strong><a href="https://www.doi.org/10.1088/1367-2630/ac4ef2">NJP 24 033020 (2022)</a></strong>) and how to appropriately choose the parameters that the library takes as input.</p><h3 id="Equations-of-motion"><a class="docs-heading-anchor" href="#Equations-of-motion">Equations of motion</a><a id="Equations-of-motion-1"></a><a class="docs-heading-anchor-permalink" href="#Equations-of-motion" title="Permalink"></a></h3><p>SpiDy.jl is designed to implement the equations of spins in presence of a bath of harmonic oscillators as derived in <strong><a href="https://www.doi.org/10.1088/1367-2630/ac4ef2">NJP 24 033020 (2022)</a></strong>, which for a single spin <span>$\mathbf{S}$</span> in presence of an external field <span>$\mathbf{B}_\mathrm{ext}$</span> read</p><p class="math-container">\[\frac{\mathrm{d}\mathbf{S}}{\mathrm{d}t} =
    \gamma_e\mathbf{S}\times\left(\mathbf{B}_\mathrm{ext} + \mathbf{b}(t) + \mathbf{V}(t)\right),\]</p><p>where <span>$\gamma_e$</span> is the electron gyromagnetic ratio, <span>$b(t)$</span> is the environment induced thermal stochastic field, and</p><p class="math-container">\[\mathbf{V}(t) = \gamma_e\int_{-\infty}^{t}\mathrm{d}t&#39; \, \mathbf{K}(t-t&#39;)\mathbf{S}(t&#39;),\]</p><p>where <span>$\mathbf{K}(\tau)$</span> is a memory kernel accounting for the non-Markovian evolution of the spin (see <a href="https://www.doi.org/10.1088/1367-2630/ac4ef2">NJP 24 033020 (2022)</a> for more details). SpiDy focuses on the case of an environment with a Lorentzian spectral density, in which case these equations of motion can be rewritten as</p><p class="math-container">\[\begin{align}
\frac{\mathrm{d}\mathbf{S}}{\mathrm{d}t} &amp;=
    \gamma_e\mathbf{S}\times\left(\mathbf{B}_\mathrm{ext} + \mathbf{b} + \mathbf{V}\right), \\
\frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t} &amp;= \mathbf{W}, \\
\frac{\mathrm{d}\mathbf{W}}{\mathrm{d}t} &amp;= \gamma_e A \mathbf{S} - \omega_0^2\mathbf{V} - \Gamma\mathbf{W},
\end{align}\]</p><p>where <span>$A$</span>, <span>$\omega_0$</span>, and <span>$\Gamma$</span> parametrise the Lorentzian spectral density as</p><p class="math-container">\[J(\omega) = \frac{A\Gamma}{\pi} \frac{\omega}{(\omega_0^2 - \omega^2)^2 + \omega^2\Gamma^2},\]</p><p>and the thermal stochastic <span>$\mathbf{b}$</span> field is given by</p><p class="math-container">\[\mathbf{b}(t) = \int_{-\infty}^{+\infty}\mathrm{d}t&#39; F(t-t&#39;) \xi(t&#39;),\]</p><p>with <span>$\xi$</span> being white noise and</p><p class="math-container">\[F(\tau) = \frac{1}{2\pi}\int_{-\infty}^{+\infty}\mathrm{d}\omega
    e^{-i\omega\tau} \sqrt{P(\omega)}.\]</p><p>Here, <span>$P(\omega)$</span> is the power spectral density of the environment, and it is given in terms of the Lorentzian spectral density <span>$J(\omega)$</span> and the environment thermal noise <span>$N(\omega)$</span> by <span>$P(\omega) = \hbar\pi J(\omega) N(\omega)$</span>. The noise <span>$N(\omega)$</span> can be classical, &quot;quantum&quot;, or &quot;quantum&quot; with no zero point fluctuations. For example, for the &quot;quantum&quot; case we have</p><p class="math-container">\[N_\mathrm{qu}(\omega) = \coth\left(\frac{\hbar\omega}{2k_\mathrm{B}T}\right).\]</p><p>Note that in these equations above, all quantities have standard units.</p><h3 id="Units-rescaling"><a class="docs-heading-anchor" href="#Units-rescaling">Units rescaling</a><a id="Units-rescaling-1"></a><a class="docs-heading-anchor-permalink" href="#Units-rescaling" title="Permalink"></a></h3><p>SpiDy.jl implements these equations in a unit-free way, following the conventions of <strong><a href="https://www.doi.org/10.1088/1367-2630/ac4ef2">NJP 24 033020 (2022)</a></strong>. In summary, consider a spin of length <span>$\hbar S_0$</span> is in presence of a reference magnetic field of magnitude <span>$B_0$</span>. We then define the Larmor frequency</p><p class="math-container">\[\omega_\mathrm{L} = |\gamma_e| B_0,\]</p><p>with <span>$\gamma_e$</span> the electron gyromagnetic ratio.</p><p>SpiDy.jl then takes as input parameters for the simulation the following <strong>unit free</strong> parameters:</p><ul><li><span>$S_0$</span>: the spin length (in units of <span>$\hbar$</span>).</li><li><span>$\bar{B}_\mathrm{ext}$</span>: external magnetic field.</li><li><span>$\bar{t}_\mathrm{end}$</span>: final time of the evolution.</li><li><span>$\mathrm{d}\bar{t}$</span>: time differential.</li><li><span>$\bar{\omega}_0$</span>: peak frequency of the Lorentzian spectral density.</li><li><span>$\bar{\Gamma}$</span>: width of the Lorentzian spectral density.</li><li><span>$\bar{\alpha}$</span>: amplitude of the Lorentzian spectral density.</li><li><span>$\bar{T}$</span>: the environment temperature.</li></ul><p>These unit-free quantities (denoted hereon by a bar on top) are related to the unitful quantities in the previous section by the following conversions:</p><p class="math-container">\[\begin{align}
\mathbf{B}_\mathrm{ext} &amp;= B_0 \, \bar{B}_\mathrm{ext}, \\
t_\mathrm{end} &amp;= \omega_\mathrm{L}^{-1} \, \bar{t}_\mathrm{end}, \\
\mathrm{d}t &amp;= \omega_\mathrm{L}^{-1} \, \mathrm{d}\bar{t}, \\
\omega_0 &amp;= \omega_\mathrm{L} \, \bar{\omega}_0, \\
\Gamma &amp;= \omega_\mathrm{L} \, \bar{\Gamma}, \\
\omega_0 &amp;= \omega_\mathrm{L} \, \bar{\omega}_0, \\
A &amp;= \frac{B_0^2\omega_\mathrm{L}}{\hbar S_0} \, \bar{\alpha}, \\
T &amp;= \frac{\hbar\omega_\mathrm{L}}{k_\mathrm{B}} \, \bar{T}.
\end{align}\]</p><p>Given these choices of rescaling and adimensionalisation and plugging them in the equations of motion of the previous section, one finally gets the equations being solved by SpiDy, that is</p><p class="math-container">\[\begin{align}
\frac{\mathrm{d}\bar{\mathbf{S}}}{\mathrm{d}\bar{t}} &amp;=
    \bar{\mathbf{S}}\times\left(\bar{\mathbf{B}}_\mathrm{ext} + \frac{1}{\sqrt{S_0}}\bar{\mathbf{b}} + \bar{\mathbf{V}}\right), \\
\frac{\mathrm{d}\bar{\mathbf{V}}}{\mathrm{d}\bar{t}} &amp;= \bar{\mathbf{W}}, \\
\frac{\mathrm{d}\bar{\mathbf{W}}}{\mathrm{d}\bar{t}} &amp;= \bar{\alpha}\bar{\mathbf{S}} - \bar{\omega}_0^2\bar{\mathbf{V}} - \bar{\Gamma}\bar{\mathbf{W}},
\end{align}\]</p><p>with environment Lorentzian spectral density</p><p class="math-container">\[\bar{J}(\bar{\omega}) = \frac{\bar{\alpha}\bar{\Gamma}}{\pi} \frac{\bar{\omega}}{(\bar{\omega}_0^2 - \bar{\omega}^2)^2 + \bar{\omega}^2\bar{\Gamma}^2},\]</p><p>and thermal stochastic noise <span>$\bar{\mathbf{b}}$</span> with power spectral density </p><p class="math-container">\[\bar{P}(\bar{\omega}) = \pi \bar{J}(\bar{\omega})\bar{N}(\bar{\omega}).\]</p><p>For the &quot;quantum&quot; noise, the noise term is given by</p><p class="math-container">\[\bar{N}_\mathrm{qu}(\bar{\omega}) = \coth\left(\frac{\bar{\omega}}{2\bar{T}}\right),\]</p><p>while for &quot;classical&quot; noise we have</p><p class="math-container">\[\bar{N}_\mathrm{cl}(\bar{\omega}) = \frac{2\bar{T}}{\bar{\omega}}.\]</p><p>Finally, note that with these definitions above, the unit-free Gilbert damping is given by (see <a href="https://www.doi.org/10.1088/1367-2630/ac4ef2">NJP 24 033020 (2022)</a>)</p><p class="math-container">\[\eta = \frac{\bar{\alpha}\bar{\Gamma}}{\bar{\omega}_0^4}.\]</p><div class="admonition is-warning"><header class="admonition-header">Units convention in old versions of SpiDy.jl</header><div class="admonition-body"><p>Note that the unit conversion just explained, in line with <strong><a href="https://www.doi.org/10.1088/1367-2630/ac4ef2">NJP 24 033020 (2022)</a></strong>, is correct for SpiDy.jl versions 1.2.0 and later.</p><p>Older version of SpiDy.jl used a different convention, which unfortunately meant that a change of spin length <span>$S_0$</span> implied a change in temperature and time-scale, therefore requiring redefining the temperature, the paramerts of the Loretnzian, evolution time, etc.</p><p>The <strong>change in units</strong> convetion means that versions of SpiDy.jl before and after 1.2.0 will produce <strong>different results</strong>. This breaking change was made to bring the code into consistency with the article <strong><a href="https://www.doi.org/10.1088/1367-2630/ac4ef2">NJP 24 033020 (2022)</a></strong> and to make the mapping of parameters used in SpiDy.jl to real units much easier and more straightforward (see also next section).</p><p>Finally, it is worth noting that the behaviour of SpiDy.jl in <strong>older versions</strong> can be exactly <strong>recovered</strong> by passing the option <strong><span>$S_0 = 1$</span></strong> to the integrator, since in that case both units <strong>conventions agree</strong>.</p></div></div><h2 id="Extracting-Lorentzian-units-from-experimental-data"><a class="docs-heading-anchor" href="#Extracting-Lorentzian-units-from-experimental-data">Extracting Lorentzian units from experimental data</a><a id="Extracting-Lorentzian-units-from-experimental-data-1"></a><a class="docs-heading-anchor-permalink" href="#Extracting-Lorentzian-units-from-experimental-data" title="Permalink"></a></h2><p>To be written.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Start with SpiDy.jl</a><a class="docs-footer-nextpage" href="../noise/">Noise »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 20 August 2024 10:57">Tuesday 20 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
